# 并行分布式计算实验报告

## 一、基于 OpenMP 的并行快速排序 (parallel_quicksort.cpp)

### 1. 实现方式
该文件实现了一个基于 OpenMP 的并行快速排序算法，主要特点包括：

- **核心算法**：手动实现的快速排序算法，包含串行和并行两个版本
- **并行化策略**：使用 OpenMP 的 `sections` 指令对快速排序的左右子数组进行并行处理
- **递归深度控制**：限制递归深度（最大 4 层），超过阈值后自动切换为串行排序，避免创建过多线程导致的性能下降

### 2. 主要功能模块
- **`quicksort_serial`**：串行快速排序实现
- **`quicksort_parallel`**：并行快速排序实现，包含递归深度控制
- **`generate_random_array`**：生成指定大小的随机整数数组
- **`test_performance`**：性能测试函数，比较串行和并行排序的时间

### 3. 测试配置
- **数据量**：1000、5000、10000、100000 个元素
- **线程数**：1、2、4、8、16 个线程
- **结果验证**：自动检查排序结果的正确性

## 二、基于 Socket 的 PSRS 并行排序 (psrs_socket.cpp)

### 1. 实现方式
该文件实现了 Parallel Sorting by Regular Sampling (PSRS) 算法，采用 Socket 通信实现分布式并行排序，主要特点包括：

- **通信方式**：使用 Windows Socket API (Winsock2) 实现服务器-客户端架构
- **完整 PSRS 算法**：包含数据划分、局部排序、正则采样、主元选择、数据重划分和归并排序等完整步骤
- **多路归并**：使用优先队列实现高效的多路归并排序

### 2. 主要功能模块
- **`SocketComm`**：Socket 通信类，封装了服务器创建、客户端连接、数据发送/接收/广播等功能
- **`psrs_server`**：服务器端 PSRS 算法实现，负责数据生成、任务分配和结果合并
- **`psrs_client`**：客户端 PSRS 算法实现，负责局部排序、采样和数据划分
- **`generate_random_array`**：生成指定大小的随机整数数组

### 3. 测试配置
- **数据量**：支持 1000、5000、10000、100000 等不同数据量
- **客户端数量**：可配置 1、2、4 等多个客户端
- **通信模式**：同一台机器上使用本地回环地址 (127.0.0.1) 测试，支持多机分布式测试

## 三、两种实现的比较

| 比较维度 | 并行快速排序 (OpenMP) | PSRS 并行排序 (Socket) |
|---------|---------------------|-----------------------|
| 并行模型 | 共享内存并行        | 分布式内存并行        |
| 通信方式 | 共享内存，无显式通信 | Socket 网络通信       |
| 适用场景 | 单台多核机器        | 多台机器组成的集群    |
| 实现复杂度 | 较低                | 较高                  |
| 通信开销 | 极低                | 较高                  |
| 扩展性 | 受限于单台机器核心数 | 可扩展到多台机器      |

## 四、结论

两个实现分别展示了共享内存和分布式内存两种并行计算模型下的排序算法实现。基于 OpenMP 的并行快速排序实现简单，适合单台多核机器；而基于 Socket 的 PSRS 实现则展示了分布式环境下的并行排序算法，适合多机集群环境。两者都支持多种数据量和并行度的测试，能够满足不同场景下的并行排序需求。